@model LoanApplicationService.Service.DTOs.CustomerModule.CustomerDto
@{
    Layout = "~/Views/Customer/Shared/_CustomerLayout.cshtml";
    ViewData["Title"] = "Edit Profile";
}

<div class="container mt-4">
    <div class="form-card">
        <div class="form-card-header">
            <h2>Edit Profile</h2>
        </div>
        
        <div class="form-card-body">
            @if (TempData["Error"] != null)
            {
                <div class="alert alert-danger w-100">@TempData["Error"]</div>
            }
            @if (TempData["ProfileSuccess"] != null)
            {
                <div class="alert alert-success w-100">@TempData["ProfileSuccess"]</div>
            }
            
            @using (Html.BeginForm("EditProfile", "Customer", FormMethod.Post, new { @class = "w-100" }))
            {
                @Html.AntiForgeryToken()
                @Html.HiddenFor(model => model.CustomerId)
                @Html.HiddenFor(model => model.FirstName)
                @Html.HiddenFor(model => model.LastName)
                @Html.HiddenFor(model => model.DateOfBirth)
                @Html.HiddenFor(model => model.NationalId)
                @Html.ValidationSummary(true, "", new { @class = "text-danger w-100" })
                
                @Html.Partial("CustomerProfileFormFields", Model)
                
                <div class="form-card-footer d-flex flex-column flex-md-row align-items-md-center justify-content-between w-100 mt-4">
                    <button type="submit" class="btn btn-primary mb-2 mb-md-0">Save Changes</button>
                    <a href="/Customer/Profile" class="btn btn-secondary">Cancel</a>
                </div>
            }
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        function togglePasswordVisibility(inputId, btn) {
            var input = document.getElementById(inputId);
            var icon = btn.querySelector('i');
            if (input.type === "password") {
                input.type = "text";
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = "password";
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }
    </script>
}
@using LoanApplicationService.CrossCutting.Utils
@{
    ViewData["Title"] = "Customer Dashboard";
    Layout = "~/Views/Customer/Shared/_CustomerLayout.cshtml";
    
    // Get data from ViewBag
    var totalApplications = ViewBag.TotalApplications ?? 0;
    var activeLoans = ViewBag.ActiveLoans ?? 0;
    var totalBorrowed = ViewBag.TotalBorrowed ?? 0m;
    var availableCredit = ViewBag.AvailableCredit ?? 0m;
    var recentApplications = ViewBag.RecentApplications as List<LoanApplicationService.Service.DTOs.LoanApplicationModule.LoanApplicationDto> ?? new List<LoanApplicationService.Service.DTOs.LoanApplicationModule.LoanApplicationDto>();
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="page-title-box">
                <div class="page-title-right">
                    <ol class="breadcrumb m-0">
                        <li class="breadcrumb-item"><a href="javascript: void(0);">Home</a></li>
                        <li class="breadcrumb-item active">Customer Dashboard</li>
                    </ol>
                </div>
                <h4 class="page-title">Customer Dashboard</h4>
            </div>
        </div>
    </div>

    @if (TempData["WelcomeMessage"] != null)
    {
        <div id="welcomeMsg" class="alert alert-success alert-dismissible fade show mb-4">
            <i class="bi bi-check-circle me-2"></i>
            @TempData["WelcomeMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        <script>
            setTimeout(function() {
                var msg = document.getElementById('welcomeMsg');
                if (msg) {
                    msg.style.opacity = '0';
                    msg.style.transition = 'opacity 0.5s ease-out';
                    setTimeout(function() {
                        if (msg) msg.style.display = 'none';
                    }, 500);
                }
            }, 4000);
        </script>
    }

    <div class="row">
        <div class="col-xl-3 col-md-6">
            <a href="@Url.Action("Index", "LoanApplication")" style="text-decoration: none;">
                <div class="card" style="cursor: pointer;">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h5 class="text-muted fw-normal mt-0" title="Number of Customers">My Loan Applications</h5>
                                <h3 class="mt-3 mb-3">@totalApplications</h3>
                            </div>
                            <div class="avatar-sm">
                                <span class="avatar-title bg-soft-primary rounded">
                                    <i class="dripicons-briefcase font-20 text-primary"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </a>
        </div>

        <div class="col-xl-3 col-md-6">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h5 class="text-muted fw-normal mt-0" title="Number of Orders">Active Loans</h5>
                            <h3 class="mt-3 mb-3">@activeLoans</h3>
                        </div>
                        <div class="avatar-sm">
                            <span class="avatar-title bg-soft-primary rounded">
                                <i class="dripicons-cart font-20 text-primary"></i>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        
    </div>

    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <h4 class="header-title mb-3">Quick Actions</h4>
                    <div class="row">
                        <div class="col-md-3">
                            <a href="@Url.Action("Index", "LoanProduct")" class="btn btn-primary btn-lg w-100 mb-3">
                                <i class="mdi mdi-plus-circle me-2"></i>
                                Apply for Loan
                            </a>
                        </div>

                        <div class="col-md-3">
                            <a href="@Url.Action("EditProfile", "Customer")" class="btn btn-warning btn-lg w-100 mb-3">
                                <i class="mdi mdi-account-edit me-2"></i>
                                Update Profile
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div> 